// After you get the new image URL (e.g. from Imgur)
const res = await fetch(`${API_URL}/${playerId}`);
const json = await res.json();
const key = Object.keys(json)[0];
const row = json[key];

let pdata = {};
try { pdata = JSON.parse(row.data || "{}"); } catch { pdata = {}; }

if (!Array.isArray(pdata.gallery)) pdata.gallery = [];
pdata.gallery.push(newImageUrl);

await fetch(`${API_URL}/${playerId}`, {
  method: "PUT",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify({ blad1: { data: JSON.stringify(pdata) } })
});
